# Table of Contents

* [1 文件](#1-文件)
* [2 文件系统模型](#2-文件系统模型)
* [3 文件逻辑结构](#3-文件逻辑结构)
  * [3.1 有结构文件](#31-有结构文件)
  * [3.2 无结构文件](#32-无结构文件)
* [4 文件目录](#4-文件目录)
* [5 文件共享](#5-文件共享)
  * [5.1 概念](#51-概念)
  * [5.2 实现方式](#52-实现方式)
    * [5.2.1 基于索引节点的实现方式](#521-基于索引节点的实现方式)
    * [5.2.2 利用符号链接实现共享](#522-利用符号链接实现共享)
* [6 文件保护](#6-文件保护)
  * [6.1 访问权和保护域](#61-访问权和保护域)
  * [6.2 访问矩阵](#62-访问矩阵)



# 1 文件
文件是具有文件名的一组相关信息的集合，文件名由文件创建者在创建文件时给出，每个系统都有自己的文件命名规则，通常由一串`ASCII`码组成，文件的基本内容可以由零个或多个字节构成。这些字节可以是简单的字符流，也可以是一个或多个记录的集合。

每个文件除了文件名和基本内容意外，还有自己的属性，如：

- 文件类型
- 文件长度
- 文件的物理位置
- 文件的建立时间

等。

# 2 文件系统模型
文件系统就是操作系统中与文件管理有关的那部分软件以及被它们管理的文件和文件属性的集合额，可以分成如下层次：

- 对象及其属性
- 对对象操纵和管理的软件集合
- 文件系统接口

# 3 文件逻辑结构
从逻辑结构出发可以将文件分为有结构文件和无结构文件。
## 3.1 有结构文件
也叫记录式文件，数据的组成可以分成：

- 数据项：可以用来描述一个个体的属性
- 记录：多个数据项的集合形成一个记录，可用一个或多个数据项唯一标识一个记录，这些数据项的集合称为关键字
- 文件：多个记录的有序集合构成文件

记录式文件可以分为：

- 顺序文件：记录可按不同的顺序进行排列，若按存入顺序依次记录，则称为串结构文件，按关键字次序进行排列，则叫顺序结构文件。顺序文件中的记录通常是定长记录，因此具有较快的检索速度
- 索引文件：为每个文件建立一张索引表，并将主文件的每个记录的关键字、长度和逻辑地址记录在索引表中。索引表本身的定长记录文件
- 索引顺序文件：是顺序文件和索引文件构成方式的组合，记录按顺序方式组织，每个文件也需建立一个索引表

## 3.2 无结构文件
是指由字符流构成的文件，又叫流式文件，基本单位是字节，可以看成是记录式文件的一个特例。

# 4 文件目录
文件控制块（`FCB`）是`OS`用来描述和控制文件的一个数据结构，其中最基本的内容是文件名和文件的物理地址，其他的内容通常由文件的逻辑结构、文件的物理结构、文件的长度、文件的存取权限等。文件控制块与文件一一对应，文件控制块的有序集合被称作目录，其中的每个文件控制块被称为目录项，目录通常以文件的形式存放在外存上，因此也被称作目录文件。


# 5 文件共享
## 5.1 概念
文件共享是指系统允许多个用户或多个进程使用同一份文件。

## 5.2 实现方式
主要有两种：

- 基于索引节点
- 利用符号链接


### 5.2.1 基于索引节点的实现方式
使用该方式时，可在文件的索引结点中设置一个链接技术字段`i_nlink`，用来表示链接到本索引结点上的用户目录项数目，一个新文件的链接计数为1，有其他用户共享时，在该用户的目录增加一个目录项，并将索引结点中的链接计数将被加1。

### 5.2.2 利用符号链接实现共享
利用一个叫`LINK`类型的文件，当访问该类文件时，被`OS`截获，根据其中的路径名去读取实际的文件。


# 6 文件保护
## 6.1 访问权和保护域
- 访问权：是一个用户对某个对象执行操作的权利，可以用一有序对来表示
- 保护域 ：是用户或进程对一组对象的访问权的集合

## 6.2 访问矩阵
访问矩阵是用来描述系统的访问控制的一张二维表，行代表一个保护域，列代表系统中的一个对象，矩阵中的每一项由一组访问权组成。在实际应用中通常采用访问控制表或访问权限表的方式实现。

访问控制表就是将访问矩阵按列（对象）进行划分，为每个列建立一张访问控制表，由有序对组成。

而访问权限表是将访问矩阵按行（域）进行划分，表中的每一项即为该域对某对象的访问权限。
